<!DOCTYPE html>

<html lang="en">

<head>
    <title>Paper Outbound Shipments Refresh</title>
    <!--
        Purpose: 
            Create refresh of data from Tableau server.  Details in code. 
    -->
    <script type="text/javascript" src="https://bi.padnos.com/javascripts/api/tableau_v8.js"></script>
    <!--JS API on Tableau Server -->
</head>

<body>
    <!--Div element for viz. Viz generated by script -->
    <div id= "tableauViz"></div> 

    <script type='text/javascript'>
        // Script generated following API documentation from Tableau:
        // https://onlinehelp.tableau.com/current/api/js_api/en-us/JavaScriptAPI/js_api_concepts_initializing.htm
        
        //Initialize the API by using the object model.  Create object, then instantiate.  (reverse from Tableau doc)

        //Create a new Viz object 
        var placeholderDiv = document.getElementById("tableauViz");
        var url = 'https://bi.padnos.com/views/InboundandOutboundPaperLoadsLAandSCH/TodaysSchedInboundandOutbound';
            //URL must match https://my-server/views/my-workbook/my-view NOTE: no # or session identifier in URL string  
        var options = 
            { //var options follows API documentation.  
                hideTabs: true,
                width: "100%", //use % scalar not literal pixel. 
                height: "1000px",  
                onFirstInteractive: function() 
                {
                    //now safe to use viz via API function(s)
                }
            }; //end var options 
        
        //instantiate new viz object 
        var viz = new tableau.Viz(placeholderDiv, url, options);

        //Set the referseh interval on object function in ms 
        setInterval(function () {viz.refreshDataAsync() }, 10000);

    </script>
</body>